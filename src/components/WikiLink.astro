---
/**
 * WikiLink Component
 * Renders [[wikilink]] style links with proper styling and broken link detection
 */

interface Props {
  href: string;
  label?: string;
  exists?: boolean;
}

const { href, label, exists = true } = Astro.props;

// Extract the display text from the slot or use the label/href
const displayText = label || href.split('/').pop()?.replace(/-/g, ' ') || href;
---

<a
  href={href}
  class:list={['wiki-link', { 'wiki-link-new': !exists }]}
  data-wiki-link
  title={exists ? displayText : `${displayText} (page does not exist)`}
>
  <slot>{displayText}</slot>
</a>

<style>
  .wiki-link {
    color: var(--link-color);
    text-decoration: none;
    border-bottom: 1px solid var(--link-color-muted);
    transition: border-color 0.2s ease, color 0.2s ease;
  }

  .wiki-link:hover {
    border-bottom-color: var(--link-color);
  }

  .wiki-link-new {
    color: var(--text-muted);
    border-bottom-style: dashed;
    cursor: help;
  }

  .wiki-link-new:hover {
    color: var(--link-color);
  }
</style>
